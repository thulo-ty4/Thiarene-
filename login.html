<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connexion</title>
  <link rel="stylesheet" href="css/style.css"> <!-- Chemin vers ton CSS -->

</head>

<body>
  <div class="auth-container">
    <div class="auth-box animate__animated animate__fadeIn">
      <div class="logo">
        <h2 class="animate__animated animate__fadeInDown">Thiarene+</h2>
      </div>

      <form id="loginForm" class="animate__animated animate__fadeIn animate__delay-1s">
        <div class="input-group">
          <i class="fas fa-envelope"></i>
          <input type="email" id="login-email" placeholder="Email" required />
        </div>

        <div class="input-group">
          <i class="fas fa-lock"></i>
          <input type="password" id="login-password" placeholder="Mot de passe" required />
        </div>

        <button type="submit" class="animate__animated animate__fadeIn animate__delay-3s">
          <i class="fas fa-sign-in-alt"></i> Se connecter
        </button>
      </form>
<form id="myForm" action="/verify" method="POST">
  <input type="text" name="username" placeholder="Nom d'utilisateur" required>
  <input type="password" name="password" placeholder="Mot de passe" required>

  <!-- reCAPTCHA -->
  <div class="g-recaptcha" data-sitekey="6LcHF6MrAAAAAJeDUlPLcrpx82Eka3w0-ITWmLpo"></div>

  <button type="submit">Envoyer</button>
</form>

<!-- Script reCAPTCHA -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
      <div class="social-login animate__animated animate__fadeIn animate__delay-4s">
        <p>Ou connectez-vous avec</p>
        <div class="social-icons">
          <div id="googleSignIn" class="social-icon google" title="Se connecter avec Google">
            <i class="fab fa-google"></i>
          </div>
          <div id="facebookSignIn" class="social-icon facebook" title="Se connecter avec Facebook">
            <i class="fab fa-facebook-f"></i>
          </div>
          <div class="social-icon twitter" title="Twitter non implémenté">
            <i class="fab fa-twitter"></i>
          </div>
        </div>
      </div>

      <div class="link animate__animated animate__fadeIn animate__delay-5s">
        <a href="register.html">Pas encore de compte ? Créer un compte</a>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, GoogleAuthProvider, FacebookAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAfaaMyk4_CjF9SwJ4D0o-r0A5jENFJxOc",
      authDomain: "blossomverse-lgajk.firebaseapp.com",
      projectId: "blossomverse-lgajk",
      storageBucket: "blossomverse-lgajk.appspot.com",
      messagingSenderId: "588813220309",
      appId: "1:588813220309:web:ea1934d655e1d2397ce55c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Connexion Email/Password
    const form = document.getElementById('loginForm');
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value.trim();

      if (!email || !password) {
        alert('Veuillez remplir tous les champs');
        return;
      }

      const btn = form.querySelector('button');
      btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Connexion en cours...';
      btn.disabled = true;

      signInWithEmailAndPassword(auth, email, password)
        .then(() => {
          alert('✅ Connexion réussie ! Redirection en cours...');
          window.location.href = 'index.html'; // adapte vers ta page d’accueil
        })
        .catch(error => {
          btn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Se connecter';
          btn.disabled = false;
          let errorMessage = 'Erreur de connexion';
          switch(error.code) {
            case 'auth/invalid-email':
              errorMessage = 'Email invalide';
              break;
            case 'auth/user-disabled':
              errorMessage = 'Compte désactivé';
              break;
            case 'auth/user-not-found':
              errorMessage = 'Utilisateur non trouvé';
              break;
            case 'auth/wrong-password':
              errorMessage = 'Mot de passe incorrect';
              break;
            default:
              errorMessage = error.message;
          }
          alert('❌ ' + errorMessage);
        });
    });

    // Connexion Google
    const googleProvider = new GoogleAuthProvider();
    document.getElementById('googleSignIn').addEventListener('click', () => {
      signInWithPopup(auth, googleProvider)
        .then((result) => {
          alert('✅ Connexion Google réussie ! Redirection...');
          window.location.href = 'index.html';
        })
        .catch((error) => {
          alert('❌ Erreur Google : ' + error.message);
        });
    });

    // Connexion Facebook
    const facebookProvider = new FacebookAuthProvider();
    document.getElementById('facebookSignIn').addEventListener('click', () => {
      signInWithPopup(auth, facebookProvider)
        .then((result) => {
          alert('✅ Connexion Facebook réussie ! Redirection...');
          window.location.href = 'index.html';
        })
        .catch((error) => {
          alert('❌ Erreur Facebook : ' + error.message);
        });
    });
    auth.signInWithEmailAndPassword(email, password)
  .then((userCredential) => {
    // Connexion réussie → redirige
    window.location.href = "index.html";
  })
  .catch((error) => {
    alert("Erreur : " + error.message);
  });
    import { app } from './firebase-config.js';
  </script>
</body>
  </html>
